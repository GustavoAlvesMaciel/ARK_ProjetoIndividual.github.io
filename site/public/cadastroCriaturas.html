<!DOCTYPE html>
<html lang="pt-br">

<head>
  <!-- ... Seu código CSS e meta tags ... -->
  <style>
    /* Adicione seus estilos personalizados aqui */
  </style>
</head>

<body>
  <div class="header">
    <!-- ... Seu cabeçalho ... -->
  </div>

  <div class="login">
    <div class="container">
      <div class="card card-cadastro">
        <h2>Cadastro de Espécie</h2>
        <form id="cadastroForm">
          <label for="especie">Espécie:</label>
          <input type="text" id="especie" name="especie" required>

          <fieldset>
            <legend>Tipo de Farm:</legend>
            <label><input type="checkbox" name="tipoFarm" value="carne"> Carne e Derivados</label>
            <label><input type="checkbox" name="tipoFarm" value="frutos"> Frutos e Derivados</label>
            <label><input type="checkbox" name="tipoFarm" value="madeiras"> Madeiras</label>
            <label><input type="checkbox" name="tipoFarm" value="minerais"> Minerais</label>
          </fieldset>

          <label for="dieta">Dieta:</label>
          <select id="dieta" name="dieta" required>
            <option value="carnivora">Carnívora</option>
            <option value="herbivora">Herbívora</option>
            <option value="onivora">Onívora</option>
          </select>

          <label for="imagem">Inserir Imagem:</label>
          <input type="file" id="imagem" name="imagem" accept="image/*">

          <button type="button" onclick="enviarCadastro()">Cadastrar</button>
        </form>
      </div>
    </div>
  </div>

  <div class="footer">
    <!-- ... Seu rodapé ... -->
  </div>

  <script>
    function enviarCadastro() {

      var especie = document.getElementById('especie').value;
    var tipoFarm = [];
    var checkboxes = document.querySelectorAll('input[name="tipoFarm"]:checked');
    checkboxes.forEach(function (checkbox) {
      tipoFarm.push(checkbox.value);
    });
    var dieta = document.getElementById("dieta").value;
    var imagem = document.getElementById("imagem").files[0]; // Ajuste para obter o arquivo

   

    fetch("/especie/cadastrar", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
      },
      body: JSON.stringify({
        especieServer: especie,
        tipoFarmServer: tipoFarm,
        dietaServer: dieta,
        imagemServer: imagem,
      }),
    })
    .then(function (resposta) {
        console.log("resposta: ", resposta);

        if (resposta.ok) {
          cardErro.style.display = "block";
          mensagem_erro.innerHTML = "Cadastro realizado com sucesso! Redirecionando para tela de Login...";

          setTimeout(() => {
            window.location = "login.html";
          }, '2000');

          limparFormulario();
          finalizarAguardar();
        } else {
          throw "Houve um erro ao tentar realizar o cadastro!";
        }
      })
      .catch(function (resposta) {
        console.log(`#ERRO: ${resposta}`);
        finalizarAguardar();
      });

    return false;
  }

  </script>
</body>

</html>
